/*! For license information please see 872.804927f4.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkcheckers=self.webpackChunkcheckers||[]).push([[872],{872:(e,t,r)=>{r.r(t),r.d(t,{default:()=>S});var n=r(5043),o=r(5040),s=r(7497),i=r(579);const a=(0,n.createContext)(null),l=e=>{let{children:t}=e;const r=(()=>{const{currentPlayer:e,boardGrid:t}=(0,o.C$)(),[r,i]=(0,n.useState)(null),[a,l]=(0,n.useState)((0,s.nZ)(t,e));return{selectedPosition:r,setSelectedPosition:i,currentPlayerMoveTrees:a,setCurrentPlayerMoveTrees:l}})();return(0,i.jsx)(a.Provider,{value:r,children:t})};var d=r(4451),u=r(9050),c=r(3910),h=r(7929);const p={},f={},g=()=>{const{stoneDiameter:e}=(0,o.C$)();return(t=>{const r=f[e];if(r)return r;const n=t();return f[e]=n,n})((()=>{const{width:t,height:r,left:n,top:o}=(()=>{const t=p[e];if(t)return t;const r=Math.round(.5*e*10)/10,n=Math.round((e-r)/2*10)/10,o={width:r,height:r,left:n,top:n};return p[e]=o,o})();return(0,i.jsx)(c.g,{icon:h.zqi,className:"position-absolute",style:{width:`${t}px`,height:`${r}px`,left:`${n}px`,top:`${o}px`,color:"gold"}})}))},x=e=>{const{position:t,player:r,isKing:s}=e,{tileSize:l,stoneDiameter:d,currentPlayer:u}=(0,o.C$)(),{selectedPosition:c,setSelectedPosition:h,currentPlayerMoveTrees:p}=function(){const e=(0,n.useContext)(a);if(!e)throw new Error("usMovesStorageContext must be used within a MovesStorageProvider");return e}(),f=(0,n.useMemo)((()=>{const[e,r]=t,n=Math.round((l-d)/2*10)/10,o=Math.round(10*(r*l+n))/10,s=Math.round(10*(e*l+n))/10;return{diameter:d,left:o,top:s}}),[t,l,d]),x=(0,n.useMemo)((()=>{if(r!==u)return!1;const e=t.toString();return!!p[e]}),[u,r,p,t]),w=(0,n.useMemo)((()=>{if(!c)return!1;return c[0]===t[0]&&c[1]===t[1]}),[c,t]),{diameter:m,left:b,top:v}=f;return(0,i.jsx)("div",{className:"stone"+(w?" selected-stone":""),style:{width:`${m}px`,height:`${m}px`,left:`${b}px`,top:`${v}px`,backgroundColor:`var(--player-${r}-stone-color)`},draggable:x,onMouseDown:e=>{x?w||h(t):e.preventDefault()},onDragOver:e=>{w&&e.preventDefault()},children:s&&(0,i.jsx)(g,{})})},w=()=>{const{boardGrid:e,setStoneDiameter:t,tileSize:r}=(0,o.C$)();return(0,n.useEffect)((()=>{t(.75*r)}),[r,t]),(0,i.jsx)(i.Fragment,{children:e.flatMap((e=>e.map((e=>{if(!e)return null;const{position:t,player:r,isKing:n,id:o}=e;return(0,i.jsx)(x,{position:t,player:r,isKing:n},o)}))))})},m=()=>{const{tileSize:e,setTileSize:t,boardSize:r,setBoardSize:s}=(0,o.C$)(),{boardRowsAmount:a}=(0,u.N)(),l=(0,n.useCallback)((()=>{const e=.8*window.innerHeight,t=.8*window.innerWidth,r=Math.min(e,t),n=Math.floor(r/a);return{boardSize:n*a,tileSize:n}}),[a]),d=(0,n.useCallback)((()=>{const{boardSize:r,tileSize:n}=l();n!==e&&(s(r),t(n))}),[e,s,t,l]);(0,n.useEffect)((()=>(window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)})),[d]),(0,n.useEffect)((()=>{d()}),[d]);const c=2*e;return(0,i.jsx)("div",{className:"position-absolute m-auto top-0 bottom-0 start-0 end-0 border border-dark","data-testid":"board",style:{width:`${r}px`,height:`${r}px`,background:"linear-gradient(to bottom, black 50%, white 50%), linear-gradient(to right, white 50%, black 50%)",backgroundBlendMode:"difference, normal",backgroundSize:`${c}px ${c}px`},children:(0,i.jsx)(w,{})})},b=(0,n.lazy)((()=>r.e(162).then(r.bind(r,6162)))),v=e=>{const{toggleComponent:t}=e,{isGameOver:r,winner:s,setIsGamePaused:a,setIsGameRunning:l}=(0,o.C$)();return(0,n.useEffect)((()=>{const e=e=>{"Escape"===e.key&&(a(!0),t("escapeMenu"))};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[t,a]),(0,n.useEffect)((()=>{a(!1),l(!0)}),[a,l]),(0,i.jsxs)(i.Fragment,{children:[r&&null!==s&&(0,i.jsx)(n.Suspense,{fallback:(0,i.jsx)(d.A,{}),children:(0,i.jsx)(b,{toggleComponent:t})}),(0,i.jsx)(m,{})]})},S=e=>(0,i.jsx)(l,{children:(0,i.jsx)(v,{...e})})}}]);
//# sourceMappingURL=872.804927f4.chunk.js.map